<main class="tint-demo">
	<div class="tint-demo__controls">
		<label>
			Surface color
			<input class="tint-demo__picker" type="color" value="#f1d2c4" />
		</label>
	</div>

	<div class="tint-demo__grid">
		<div class="tint-demo__card tint-demo__card--neutral">Neutral shadow</div>
		<div class="tint-demo__card tint-demo__card--matched">Color-matched shadow</div>
	</div>
</main>

<script is:inline>
	const hexToHsl = (hex) => {
		const cleaned = hex.replace('#', '');
		const r = parseInt(cleaned.slice(0, 2), 16) / 255;
		const g = parseInt(cleaned.slice(2, 4), 16) / 255;
		const b = parseInt(cleaned.slice(4, 6), 16) / 255;
		const max = Math.max(r, g, b);
		const min = Math.min(r, g, b);
		const delta = max - min;
		let h = 0;

		if (delta !== 0) {
			if (max === r) h = ((g - b) / delta) % 6;
			if (max === g) h = (b - r) / delta + 2;
			if (max === b) h = (r - g) / delta + 4;
			h = Math.round(h * 60);
			if (h < 0) h += 360;
		}

		const l = (max + min) / 2;
		const s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));

		return { h, s: Math.round(s * 100), l: Math.round(l * 100) };
	};

	document.querySelectorAll('.tint-demo').forEach((demo) => {
		const picker = demo.querySelector('.tint-demo__picker');

		const update = (hex) => {
			const { h, s, l } = hexToHsl(hex);
			const shadowL = Math.max(12, l - 35);
			const text = l < 55 ? 'white' : 'hsl(220deg 20% 15%)';
			demo.style.setProperty('--surface', hex);
			demo.style.setProperty('--shadow-color', `hsl(${h}deg ${s}% ${shadowL}% / 0.32)`);
			demo.style.setProperty('--shadow-soft', `hsl(${h}deg ${s}% ${shadowL}% / 0.22)`);
			demo.style.setProperty('--text-color', text);
		};

		picker.addEventListener('input', () => update(picker.value));
		picker.addEventListener('change', () => update(picker.value));
		update(picker.value);
	});
</script>

<style>
	.tint-demo {
		--surface: #f1d2c4;
		--shadow-color: hsl(20deg 40% 20% / 0.28);
		--text-color: hsl(220deg 20% 15%);
		background: white;
		padding: 1rem 1rem 2rem;
		display: grid;
		gap: 1rem;
		max-width: 100%;
		color: black;
	}
	.tint-demo__controls {
		display: flex;
		align-items: center;
		gap: 0.5rem;
	}
	.tint-demo__picker {
		margin-left: 0.6rem;
	}
	.tint-demo__grid {
		display: grid;
		gap: 1rem;
		grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
	}
	.tint-demo__card {
		padding: 1.6rem 1rem;
		border-radius: 12px;
		background: var(--surface);
		color: var(--text-color);
		text-align: center;
	}
	.tint-demo__card--neutral {
		box-shadow:
			0 12px 24px hsl(0deg 0% 0% / 0.2),
			0 26px 44px hsl(0deg 0% 0% / 0.14);
	}
	.tint-demo__card--matched {
		box-shadow:
			0 12px 24px var(--shadow-color),
			0 26px 44px var(--shadow-soft);
	}
</style>
